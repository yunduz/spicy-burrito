<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Phaser - Making your first game, part 9</title>
  <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
  <style type="text/css">
  body {
    margin: 0;
  }
  </style>
</head>
<body>

  <script type="text/javascript">
    var game = new Phaser.Game(800, 600, Phaser.CANVAS, 'phaser-example', { preload: preload, create: create, render: render });

function preload() {

    game.load.spritesheet('button', 'assets/button_sprite_sheet.png', 193, 71);
    game.load.image('background', 'assets/bubble-on.png');
    game.load.image('close', 'assets/orb-red.png');
    game.load.image('pb', 'assets/peanut_butter_mix.jpg');

}

  var button;
  var popup;
  var tween = null;

  function create() {

      game.stage.backgroundColor = '#4b0049';

      button = game.add.button(game.world.centerX - 95, 460, 'button', openWindow, this, 2, 1, 0);
      button.input.useHandCursor = true;
    

      popup = game.add.sprite(game.world.centerX, game.world.centerY, 'pb');
      popup.alpha = 0.8;
      popup.anchor.set(0.5);
      popup.inputEnabled = true;
      popup.visible = false;
      //popup.input.enableDrag();
  }

  function openWindow() {

      popup.visible = true;
      
      //  Position the close button to the top-right of the popup sprite (minus 8px for spacing)
      var pw = (popup.width / 2) - 30;
      var ph = (popup.height / 2) - 8;

      //  And click the close button to close it down again
      var closeButton = game.make.sprite(pw, -ph, 'close');
      closeButton.inputEnabled = true;
      closeButton.input.priorityID = 1;
      closeButton.input.useHandCursor = true;
      closeButton.events.onInputDown.add(closeWindow, this);

      //  Add the "close button" to the popup window image
      popup.addChild(closeButton);

      var style = { font: "32px Arial", fill: "#ff0044", wordWrap: true, wordWrapWidth: popup.width, align: "center", backgroundColor: "#ffff00" };

      //text = game.add.text(0, 0, "- text on a sprite -\ndrag me", style);
      text = game.add.text(0, 0, "SAMPLE TEXT", style);
      text.anchor.set(0.5);
      popup.addChild(text);
      
  }

  function closeWindow() {
      popup.kill()
  }

  function render() {

      game.debug.text("Click to open window + drag + close", 32, 32);

  }

  </script>

</body>
</html>
