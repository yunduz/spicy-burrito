<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Phaser - Making your first game, part 9</title>
  <script src="//cdn.jsdelivr.net/phaser/2.2.2/phaser.min.js"></script>
  <style type="text/css">
  body {
    margin: 0;
  }
  </style>
</head>
<body>

  <script type="text/javascript">
  var g_width = 800;
  var g_height = 600;

  var game = new Phaser.Game(g_width, g_height, Phaser.AUTO, '', { preload: preload, create: create, update: update });
  function preload() {
    // game.load.baseURL = 'http://examples.phaser.io/assets/';
    // game.load.crossOrigin = 'anonymous';

    game.load.image('sky', 'assets/sky.png');
    game.load.image('star', 'assets/star.png');
    game.load.image('box', 'assets/platform.png');
  }
  var player;
  var boxes;
  var cursors;
  var stars;
  var score = 0;
  var scoreText;
  function create() {
    //  We're going to be using physics, so enable the Arcade Physics system
    game.physics.startSystem(Phaser.Physics.ARCADE);
    //  A simple background for our game
    var sky = game.add.sprite(0, 0, 'sky');
    sky.scale.setTo(2, 1.5);

    boxes = game.add.group();
    boxes.enableBody = true;
    for (var i = 0; i < 3; i++)
    {
      var box = boxes.create(50+i*250, game.world.height-64, 'box');
      box.scale.setTo(0.3,1);
      box.body.immovable = true;
    }

    //  Finally some stars to collect
    stars = game.add.group();
    //  We will enable physics for any star that is created in this group
    stars.enableBody = true;
    //  Here we'll create 12 of them evenly spaced apart
    for (var i = 0; i < 12; i++)
    {
      //  Create a star inside of the 'stars' group
      var star = stars.create(i * 70, 0, 'star');
      //  Let gravity do its thing
      star.body.gravity.y = 10;

      //enaable drag
      star.inputEnabled = true;
      star.input.enableDrag(false);
    }

    scoreText = game.add.text(16, 16, 'score: 0', { fontSize: '32px', fill: '#000' });
  }
  function update() {
    game.physics.arcade.collide(stars, boxes);
    game.physics.arcade.overlap(boxes, stars, collectItem, null, this);
  }

  function collectItem (box, star) {

    // Removes the star from the screen
    star.kill();
    score += 1;
    scoreText.text = 'Score:' + score;

  }
  </script>

</body>
</html>
